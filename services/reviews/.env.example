# =============================================================================
# REVIEWS SERVICE - Environment Configuration
# =============================================================================
# This file contains all environment variables required by the Reviews service.
# Copy this file to .env and fill in your values.
# NEVER commit .env files with real secrets to version control.
# =============================================================================

# -----------------------------------------------------------------------------
# APP METADATA
# -----------------------------------------------------------------------------
NODE_ENV=development
SERVICE_NAME=reviews-service
SERVICE_VERSION=1.0.0
PORT=3006

# -----------------------------------------------------------------------------
# DATABASE
# -----------------------------------------------------------------------------
# Supabase connection for reviews database
SUPABASE_URL=http://localhost:54321
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# Direct database connection for migrations and complex queries
DATABASE_URL=postgresql://postgres:postgres@localhost:54322/postgres

# -----------------------------------------------------------------------------
# EVENT BUS
# -----------------------------------------------------------------------------
# Message broker for event-driven communication
EVENT_BUS_URL=amqp://localhost:5672
EVENT_BUS_EXCHANGE=tripcomposer.events
EVENT_BUS_REVIEWS_QUEUE=reviews.events

# -----------------------------------------------------------------------------
# API CONNECTIVITY
# -----------------------------------------------------------------------------
# Internal service mesh URLs (no secrets, just endpoints)
INTERNAL_API_BASE_URL=http://localhost:3000/internal

# -----------------------------------------------------------------------------
# AUTHENTICATION
# -----------------------------------------------------------------------------
# JWT verification for incoming requests
JWT_PUBLIC_KEY=your-jwt-public-key-here
JWT_ISSUER=tripcomposer
JWT_AUDIENCE=reviews-service

# -----------------------------------------------------------------------------
# OPERATIONAL LIMITS
# -----------------------------------------------------------------------------
# Review submission window (days after trip completion)
REVIEW_SUBMISSION_WINDOW_DAYS=30

# Minimum booking value to allow review (prevents spam from micro-bookings)
MIN_BOOKING_VALUE_FOR_REVIEW=50

# Rate limiting
RATE_LIMIT_REVIEWS_PER_USER_PER_DAY=10
RATE_LIMIT_WINDOW_MS=86400000

# Gaming detection thresholds
GAMING_DETECTION_MIN_REVIEWS_FOR_ANALYSIS=5
GAMING_DETECTION_SUSPICIOUS_VELOCITY_THRESHOLD=3
GAMING_DETECTION_SENTIMENT_VARIANCE_THRESHOLD=0.3

# Score calculation
SCORE_DECAY_FACTOR_DAYS=180
SCORE_MIN_REVIEWS_FOR_PUBLIC=3

# -----------------------------------------------------------------------------
# FEATURE TOGGLES
# -----------------------------------------------------------------------------
FEATURE_GAMING_DETECTION_ENABLED=true
FEATURE_SENTIMENT_ANALYSIS_ENABLED=false
FEATURE_PHOTO_REVIEWS_ENABLED=false

# -----------------------------------------------------------------------------
# AUDIT / OBSERVABILITY
# -----------------------------------------------------------------------------
LOG_LEVEL=info
LOG_FORMAT=json

# Audit event publishing
AUDIT_EVENTS_ENABLED=true

# Metrics and tracing
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
OTEL_SERVICE_NAME=reviews-service
METRICS_ENABLED=true
