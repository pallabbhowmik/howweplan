# ============================================
# AUDIT SERVICE - Environment Configuration
# ============================================
# This service handles immutable event storage,
# legal traceability, and admin visibility.
# ============================================

# --------------------------------------------
# APP METADATA
# --------------------------------------------
NODE_ENV=development
SERVICE_NAME=audit-service
SERVICE_VERSION=1.0.0
PORT=3010

# --------------------------------------------
# DATABASE (Append-Only Audit Store)
# --------------------------------------------
# PostgreSQL connection for immutable audit logs
# Uses a dedicated audit database with restricted permissions
DATABASE_URL=postgresql://audit_user:audit_dev_password@localhost:5432/tripcomposer_audit
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_SSL_ENABLED=false

# --------------------------------------------
# EVENT BUS CONNECTIVITY
# --------------------------------------------
# RabbitMQ/AMQP connection for consuming domain events
EVENT_BUS_URL=amqp://guest:guest@localhost:5672
EVENT_BUS_EXCHANGE=tripcomposer.events
EVENT_BUS_QUEUE=audit.events
EVENT_BUS_PREFETCH_COUNT=10

# --------------------------------------------
# AUTHENTICATION / AUTHORIZATION
# --------------------------------------------
# Supabase service role for verifying admin tokens
SUPABASE_URL=http://localhost:54321
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key-here

# JWT verification for internal service-to-service calls
INTERNAL_SERVICE_SECRET=dev-internal-service-secret-change-in-production

# --------------------------------------------
# API CONNECTIVITY
# --------------------------------------------
# Allowed origins for CORS (admin dashboard)
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001

# --------------------------------------------
# OPERATIONAL LIMITS
# --------------------------------------------
# Maximum records per query page
MAX_PAGE_SIZE=100
DEFAULT_PAGE_SIZE=50

# Retention period in days (0 = infinite, required for legal compliance)
RETENTION_PERIOD_DAYS=0

# Rate limiting for query endpoints
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# --------------------------------------------
# AUDIT / OBSERVABILITY
# --------------------------------------------
LOG_LEVEL=info
LOG_FORMAT=json

# OpenTelemetry configuration
OTEL_ENABLED=false
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
OTEL_SERVICE_NAME=audit-service

# Health check endpoint configuration
HEALTH_CHECK_PATH=/health
READY_CHECK_PATH=/ready
