# =============================================================================
# DISPUTE SERVICE ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env and fill in appropriate values.
# NEVER commit .env files with real secrets.
# =============================================================================

# -----------------------------------------------------------------------------
# APP METADATA
# -----------------------------------------------------------------------------
NODE_ENV=development
SERVICE_NAME=disputes
SERVICE_VERSION=1.0.0
PORT=3006

# -----------------------------------------------------------------------------
# API CONNECTIVITY
# -----------------------------------------------------------------------------
# Internal service mesh URLs (no secrets, just routing)
EVENT_BUS_URL=http://localhost:3100/events
BOOKING_SERVICE_URL=http://localhost:3003
PAYMENTS_SERVICE_URL=http://localhost:3004
NOTIFICATION_SERVICE_URL=http://localhost:3005

# API versioning
API_VERSION=v1

# -----------------------------------------------------------------------------
# AUTHENTICATION
# -----------------------------------------------------------------------------
# JWT verification (public key or JWKS endpoint - NOT secret)
JWT_ISSUER=https://auth.tripcomposer.local
JWT_AUDIENCE=tripcomposer-api
JWKS_URI=http://localhost:3001/.well-known/jwks.json

# Internal service-to-service auth
INTERNAL_SERVICE_TOKEN=dev-internal-token-change-in-production

# -----------------------------------------------------------------------------
# DATABASE
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/tripcomposer_disputes
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_SSL_ENABLED=false

# -----------------------------------------------------------------------------
# SUPABASE (Backend service - allowed to have service role key)
# -----------------------------------------------------------------------------
SUPABASE_URL=http://localhost:54321
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key-here

# -----------------------------------------------------------------------------
# FEATURE TOGGLES
# -----------------------------------------------------------------------------
# Enable/disable features for gradual rollout
FEATURE_AUTO_CLOSE_STALE_DISPUTES=true
FEATURE_EVIDENCE_FILE_UPLOAD=true
FEATURE_AGENT_RESPONSE_NOTIFICATIONS=true

# -----------------------------------------------------------------------------
# OPERATIONAL LIMITS
# -----------------------------------------------------------------------------
# Dispute timing constraints (in hours)
DISPUTE_WINDOW_HOURS=168
AGENT_RESPONSE_DEADLINE_HOURS=48
ADMIN_ESCALATION_THRESHOLD_HOURS=72
AUTO_CLOSE_STALE_DISPUTES_DAYS=30

# Evidence limits
MAX_EVIDENCE_FILES_PER_DISPUTE=10
MAX_EVIDENCE_FILE_SIZE_MB=10
ALLOWED_EVIDENCE_MIME_TYPES=image/jpeg,image/png,application/pdf

# Rate limiting
RATE_LIMIT_DISPUTES_PER_USER_PER_DAY=3
RATE_LIMIT_EVIDENCE_UPLOADS_PER_DISPUTE=20

# -----------------------------------------------------------------------------
# AUDIT / OBSERVABILITY
# -----------------------------------------------------------------------------
LOG_LEVEL=debug
LOG_FORMAT=pretty
AUDIT_LOG_ENABLED=true
AUDIT_LOG_DESTINATION=database

# Tracing (OpenTelemetry compatible)
OTEL_ENABLED=false
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=disputes

# Metrics
METRICS_ENABLED=true
METRICS_PORT=9106
